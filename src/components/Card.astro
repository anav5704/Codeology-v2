---
import '../styles/main.css'
---

<div id="helloholder" class="pointer-events-none opacity-0 fixed h-full w-full glass top-0 z-20 flex items-center justify-center">
    <div class="text-black relative dark:text-white text-center md:w-72 w-4/5 rounded-md lift border-2 border-CWhite bg-white dark:bg-CGray">
        <div id="prepreloader" class="pointer-events-none opacity-0  grid place-content-center h-full z-30 w-full absolute rounded-md bg-white dark:bg-CGray">
           <div class="loader-1 center"><span></span></div>
        </div>

              <svg id="close" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="m-1 cursor-pointer dark:stroke-CWhite right-0 absolute hover:stroke-amber-500 dark:hover:stroke-amber-500 float-right w-6 h-85">
                <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
              </svg>
              
        <div id="leImg" class="img pointer-events-none"><img src="/img/freebie.png" alt="" class="h-40 aspect-square mx-auto"></div>
        <h2 class="my-2 text-xl font-bold" id = "">Want this <span class="text-amber-500">Freebie</span>?</h2>
        <p>Its a design inspiration kit. 18 Gradients + 15 Fonts + 7 Hero sections</p>
        <form action="" name="submit-to-google-sheet" id = "mailform">
            <input class="dark:bg-CGhost mt-2 w-10/12 text-black dark:text-white caret-CBlue outline-none border-2 dark:border-CGray focus:border-2 dark:focus:border-CBlue focus:border-CBlue p-1 rounded-md mb-3;" type="text" name="Name" id="name" placeholder="Name" required >
            <input class="dark:bg-CGhost mt-2 w-10/12 text-black dark:text-white caret-CBlue outline-none border-2 dark:border-CGray focus:border-2 dark:focus:border-CBlue focus:border-CBlue p-1 rounded-md mb-3;"  type="email" name="Email" id="mail" placeholder="Email" required>
        <button id="send" disabled class="sub py-2 px-4 hover:border-CBlue dark:hover:border-CBlue rounded-md border-2 border-CCool dark:border-CWhite my-3 sub" type="submit">Grab it</button>
        </form>
    </div>
</div>

<style is:inline >
    #leImg {
        rotate: -4deg;
    }

    img::selection {
        background-color: transparent;
    }

    .dark input  {
    background-color: var(--CGhost);
    transition: all .3s ease;
}

.sub:disabled {
    cursor: pointer;
}

.sub:disabled:hover {
    cursor:pointer;
    border: 2px solid red;
}

.loader-1 {
	height: 32px;
	width: 32px;
	-webkit-animation: loader-1-1 4.8s linear infinite;
	animation: loader-1-1 4.8s linear infinite;
}

@-webkit-keyframes loader-1-1 {
	0%   { -webkit-transform: rotate(0deg); }
	100% { -webkit-transform: rotate(360deg); }
}

@keyframes loader-1-1 {
	0%   { transform: rotate(0deg); }
	100% { transform: rotate(360deg); }
}

.loader-1 span {
	display: block;
	position: absolute;
	top: 0; left: 0;
	bottom: 0; right: 0;
	margin: auto;
	height: 32px;
	width: 32px;
	clip: rect(0, 32px, 32px, 16px);
	-webkit-animation: loader-1-2 1.2s linear infinite;
	animation: loader-1-2 1.2s linear infinite;
}

@-webkit-keyframes loader-1-2 {
	0%   { -webkit-transform: rotate(0deg); }
	100% { -webkit-transform: rotate(220deg); }
}

@keyframes loader-1-2 {
	0%   { transform: rotate(0deg); }
	100% { transform: rotate(220deg); }
}


.loader-1 span::after {
	content: "";
	position: absolute;
	top: 0; left: 0;
	bottom: 0; right: 0;
	margin: auto;
	height: 32px;
	width: 32px;
	clip: rect(0, 32px, 32px, 16px);
	border: 3px solid var(--CGray);
	border-radius: 50%;
	-webkit-animation: loader-1-3 1.2s cubic-bezier(0.770, 0.000, 0.175, 1.000) infinite;
	animation: loader-1-3 1.2s cubic-bezier(0.770, 0.000, 0.175, 1.000) infinite;}

.dark .loader-1 span::after {
	content: "";
	position: absolute;
	top: 0; left: 0;
	bottom: 0; right: 0;
	margin: auto;
	height: 32px;
	width: 32px;
	clip: rect(0, 32px, 32px, 16px);
	border: 3px solid var(--CWhite);
	border-radius: 50%;
	-webkit-animation: loader-1-3 1.2s cubic-bezier(0.770, 0.000, 0.175, 1.000) infinite;
	animation: loader-1-3 1.2s cubic-bezier(0.770, 0.000, 0.175, 1.000) infinite;
}

@-webkit-keyframes loader-1-3 {
	0%   { -webkit-transform: rotate(-140deg); }
	50%  { -webkit-transform: rotate(-160deg); }
	100% { -webkit-transform: rotate(140deg); }
}

@keyframes loader-1-3 {
	0%   { transform: rotate(-140deg); }
	50%  { transform: rotate(-160deg); }
	100% { transform: rotate(140deg); }
}


</style>

<script>

function closediv() {
    document.getElementById("helloholder").style.display = "none";
    sessionStorage.setItem ('modal','true');
}

document.getElementById("close").addEventListener("click", closediv)

window.addEventListener ('load', () => {
    if (sessionStorage.getItem ('modal') !== 'true') {
        var timeout = 2500; setTimeout ("document.getElementById('helloholder').style.opacity = '1'", timeout);
        var timeout = 2500; setTimeout ("document.getElementById('helloholder').style.pointerEvents = 'all'", timeout);
    }
    
    else {
        sessionStorage.setItem ('modal','true');
        document.getElementById("helloholder").style.pointerEvents = "none";
        console.log ("seen");
    }
})

// var Freebie = "http://codeology.net/freebie/";
var Freebie = "http://codeology2.netlify.app/freebie/";

let sub = document.querySelector(".sub")
const scriptURL = 'https://script.google.com/macros/s/AKfycbwjpN5B3DIR_aaSdXKRiX-k5iL1s6ziNZpi5s4PLDe6XWm3IbyS-SWn2T-8tXgb5Pk/exec'
const form = document.forms['submit-to-google-sheet']
const sending = document.getElementById("prepreloader");

form.addEventListener('submit', e => {
  e.preventDefault()
  fetch(scriptURL, { method: 'POST', body: new FormData(form)})
    .then(response => {
        console.log("sent");
        closediv();
        form.reset();
        window.location.href = (Freebie);
    }).catch(error => console.error('Error!', error.message));
})

document.getElementById("send").addEventListener("click", sent)

function sent() {
    sending.style.opacity = "1";
    var timeout = 5000; setTimeout ("sending.style.opacity = '0'", timeout);
    setTimeout(() => {
        sub.setAttribute("disabled", null);
    }, 10);
    setTimeout(() => {
        sub.removeAttribute("disabled");
    }, 5000);
}
document.getElementById("mailform").addEventListener("keyup", function() {
    var userInput = document.getElementById('name').value;
    var passInput = document.getElementById('mail').value;
    if (userInput !== '' && passInput !== '') {
        document.querySelector('.sub').removeAttribute("disabled"); 
    }
    else {
        document.querySelector('.sub').setAttribute("disabled", null);
    }  
});
</script>